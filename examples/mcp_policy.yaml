version: 1
globals:
  default_action: redact
  audit:
    enabled: true
    path: ./audit/audit.jsonl
    include_value_hash: true
  pseudonymization:
    method: hmac-sha256
    secret_key_file: ./keys/mcp_hmac_key
    salt: session

detection:
  - id: ssh_private_key
    type: regex
    pattern: '(?s)-----BEGIN (?:OPENSSH|RSA|DSA|EC|ED25519) PRIVATE KEY-----.*?-----END .*? PRIVATE KEY-----'
    action: block
    severity: critical
  - id: pem_certificate
    type: regex
    pattern: '(?s)-----BEGIN CERTIFICATE-----.*?-----END CERTIFICATE-----'
    action: block
    severity: high
  - id: aws_access_key
    type: regex
    pattern: '\b(AKIA|ASIA)[A-Z0-9]{16}\b'
    action: block
    severity: critical
  - id: gcp_api_key
    type: regex
    pattern: '\bAIza[0-9A-Za-z\-_]{35}\b'
    action: block
    severity: critical
  - id: jwt_token
    type: regex
    pattern: '\b[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_]+\.[A-Za-z0-9\-_]+\b'
    action: pseudonymize
    severity: high
  - id: email
    type: regex
    pattern: '(?i)[a-z0-9_.+\-]{1,64}@[a-z0-9\-]{1,63}(?:\.[a-z0-9\-]{1,63})+'
    action: replace_with_template
    template: '<EMAIL:{hash8}>'
    severity: medium
  - id: ipv4
    type: ipv4
    whitelist_cidrs: ['10.0.0.0/8','192.168.0.0/16','172.16.0.0/12']
    action: pseudonymize
    severity: low
  - id: ipv6
    type: ipv6
    action: pseudonymize
    severity: low
  - id: url
    type: url
    action: pseudonymize
    severity: low
  - id: high_entropy_token
    type: entropy
    min_entropy: 4.5
    min_length: 20
    action: redact
    severity: medium
